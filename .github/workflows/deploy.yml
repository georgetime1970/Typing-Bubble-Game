name: ğŸš€ Deploy to GitHub Pages

on:
  push:
    branches:
      - main # ç›‘å¬ main åˆ†æ”¯æ¨é€
  workflow_dispatch: # æ”¯æŒæ‰‹åŠ¨è§¦å‘

permissions: # è®¾ç½®å¿…è¦æƒé™ï¼Œè®© Actions æœ‰æƒå†™å…¥ GitHub Pages
  contents: read
  pages: write
  id-token: write

concurrency: #  ç¡®ä¿åŒä¸€æ—¶é—´åªè¿è¡Œä¸€ä¸ªéƒ¨ç½²ä»»åŠ¡ï¼Œé¿å…å†²çª
  group: 'pages'
  cancel-in-progress: true

jobs:
  deploy: # å¯é€‰,è®©éƒ¨ç½²è¿‡ç¨‹åœ¨ GitHub ç•Œé¢ä¸Šæ›´å¯è§†åŒ–ã€æ›´è§„èŒƒåŒ– çš„â€œè£…é¥°ä¿¡æ¯â€
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}

    runs-on: ubuntu-latest

    steps:
      - name: ğŸ“¥ Checkout repository
        uses: actions/checkout@v5 # å®˜æ–¹åŠ¨ä½œï¼šæ‹‰å–ä»£ç åˆ°è™šæ‹Ÿæœº

      # âœ… è‡ªåŠ¨ç”Ÿæˆ CNAME æ–‡ä»¶
      - name: ğŸ§¾ Generate CNAME file
        run: echo "typing.jiangyahan.com" > ./CNAME

      # âœ… ä¸Šä¼ é™æ€èµ„æº
      - name: ğŸ“¦ Upload static files
        uses: actions/upload-pages-artifact@v4
        with:
          path: ./

      # âœ… éƒ¨ç½²åˆ° GitHub Pages
      - name: ğŸš€ Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4
